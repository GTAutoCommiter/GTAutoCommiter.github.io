"use strict";(self.webpackChunkjv_blog=self.webpackChunkjv_blog||[]).push([[3848],{409:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>t});var s=n(4848),c=n(8453);const i={id:"react-source-code-doubleBufferTechnology",slug:"/react-source-code-doubleBufferTechnology",title:"\u53cc\u7f13\u5b58\u6280\u672f",date:new Date("2024-07-16T00:00:00.000Z")},o=void 0,l={id:"react/\u6e90\u7801\u9605\u8bfb/\u6570\u636e\u7ed3\u6784/react-source-code-doubleBufferTechnology",title:"\u53cc\u7f13\u5b58\u6280\u672f",description:"\u53cc\u7f13\u5b58\u6280\u672f",source:"@site/docs/react/\u6e90\u7801\u9605\u8bfb/\u6570\u636e\u7ed3\u6784/\u53cc\u7f13\u5b58\u6280\u672f.md",sourceDirName:"react/\u6e90\u7801\u9605\u8bfb/\u6570\u636e\u7ed3\u6784",slug:"/react-source-code-doubleBufferTechnology",permalink:"/docs/react-source-code-doubleBufferTechnology",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"react-source-code-doubleBufferTechnology",slug:"/react-source-code-doubleBufferTechnology",title:"\u53cc\u7f13\u5b58\u6280\u672f",date:"2024-07-16T00:00:00.000Z"},sidebar:"react",previous:{title:"ReactRootTags",permalink:"/docs/react-source-code-ReactRootTags"},next:{title:"\u9879\u76ee\u76ee\u5f55",permalink:"/docs/react-source-code-directory"}},d={},t=[{value:"\u53cc\u7f13\u5b58\u6280\u672f",id:"\u53cc\u7f13\u5b58\u6280\u672f",level:2},{value:"Q\uff1a\u80fd\u5e72\u5565\uff1f",id:"q\u80fd\u5e72\u5565",level:3},{value:"Q\uff1a\u662f\u5565\uff1f",id:"q\u662f\u5565",level:3},{value:"\u6784\u5efa/\u66ff\u6362\u6d41\u7a0b",id:"\u6784\u5efa\u66ff\u6362\u6d41\u7a0b",level:2},{value:"mount\uff08\u6302\u8f7d\u65f6\uff09",id:"mount\u6302\u8f7d\u65f6",level:3},{value:"Update\uff08\u66f4\u65b0\u65f6\uff09",id:"update\u66f4\u65b0\u65f6",level:3},{value:"\u533a\u5206fiber Root \u4e0e rootFiber",id:"\u533a\u5206fiber-root-\u4e0e-rootfiber",level:2},{value:"fiber Root",id:"fiber-root",level:3},{value:"rootFiber",id:"rootfiber",level:3}];function j(e){const r={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"\u53cc\u7f13\u5b58\u6280\u672f",children:"\u53cc\u7f13\u5b58\u6280\u672f"}),"\n",(0,s.jsx)(r.h3,{id:"q\u80fd\u5e72\u5565",children:"Q\uff1a\u80fd\u5e72\u5565\uff1f"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"A\uff1a\u66f4\u5feb\u901f\u7684\u8fdb\u884cDOM\u66f4\u65b0\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"q\u662f\u5565",children:"Q\uff1a\u662f\u5565\uff1f"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"**\u5728\u5185\u5b58\u4e2d\u6784\u5efa\uff08Fiber\u6811\uff09\u5e76\u76f4\u63a5\u66ff\u6362\uff08\u771f\u5b9edom\u6811\uff09**\u7684\u6280\u672f\u3002"}),"\n",(0,s.jsxs)(r.blockquote,{children:["\n",(0,s.jsx)(r.p,{children:"\u53cc\u7f13\u5b58\u4e2d\u7684Fiber\u6811"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"current Fiber\u6811"}),"\uff1a\u5f53\u524d\u5c4f\u5e55\u4e0a\u663e\u793a\u5185\u5bb9\u5bf9\u5e94\u7684",(0,s.jsx)(r.code,{children:"Fiber\u6811"})]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"workInProgress Fiber\u6811"}),"\uff1a\u6b63\u5728\u5185\u5b58\u4e2d\u6784\u5efa\u7684",(0,s.jsx)(r.code,{children:"Fiber\u6811"})]}),"\n",(0,s.jsxs)(r.li,{children:["\u901a\u8fc7",(0,s.jsx)(r.code,{children:"alternate"}),"\u5c5e\u6027\u8fde\u63a5"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u6784\u5efa\u66ff\u6362\u6d41\u7a0b",children:"\u6784\u5efa/\u66ff\u6362\u6d41\u7a0b"}),"\n",(0,s.jsx)(r.p,{children:"\u793a\u4f8b"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-jsx",children:"function App() {\n  const [num, add] = useState(0);\n  return (\n    <p onClick={() => add(num + 1)}>{num}</p>\n  )\n}\n\nReactDOM.render(<App/>, document.getElementById('root'));\n"})}),"\n",(0,s.jsx)(r.h3,{id:"mount\u6302\u8f7d\u65f6",children:"mount\uff08\u6302\u8f7d\u65f6\uff09"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u9996\u6b21\u6267\u884c",(0,s.jsx)(r.code,{children:"ReactDOM.render"}),"\u4f1a\u521b\u5efa",(0,s.jsx)(r.code,{children:"rootFiberNode"}),"\u548c",(0,s.jsx)(r.code,{children:"rootFiber"}),"\u3002"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/29/172ff7ddc57ebe26~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp",alt:""})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"rootFiberNode"}),"\uff1a\u6574\u4e2a\u5e94\u7528\u7684\u6839\u8282\u70b9\uff0c\u53ea\u6709\u4e00\u4e2a\u3002"]}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"rootFiber"}),"\uff1a\u5e94\u7528\u4e2d\u53ef\u4ee5\u591a\u6b21\u8c03\u7528",(0,s.jsx)(r.code,{children:"ReactDOM.render"}),"\u6e32\u67d3\u4e0d\u540c\u7684\u7ec4\u4ef6\u6811\uff0c\u6240\u4ee5\u4f1a\u62e5\u6709\u4e0d\u540c\u7684",(0,s.jsx)(r.code,{children:"rootFiber"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u63a5\u4e0b\u6765\u8fdb\u5165",(0,s.jsx)(r.code,{children:"render\u9636\u6bb5"}),"\u5728\u5185\u5b58\u4e2d\u4f9d\u6b21\u521b\u5efa",(0,s.jsx)(r.code,{children:"workInProgress fiber"}),"\u5e76\u8fde\u63a5\u5728\u4e00\u8d77\u6784\u5efa",(0,s.jsx)(r.code,{children:"workInProgress Fiber\u6811"}),"\u3002"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/29/172ff7e5678681c7~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp",alt:""})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.em,{children:"\uff08\u56fe\u4e2d\u53f3\u4fa7\u4e3a\u5185\u5b58\u4e2d\u6784\u5efa\u7684\u6811\uff0c\u5de6\u4fa7\u4e3a\u9875\u9762\u663e\u793a\u7684\u6811\uff09"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u5c06\u5df2\u6784\u5efa\u5b8c\u7684",(0,s.jsx)(r.code,{children:"workInProgress Fiber\u6811"}),"\u5728",(0,s.jsx)(r.code,{children:"commit\u9636\u6bb5"}),"\u6e32\u67d3\u5230\u9875\u9762\u3002"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/29/172ff7ec95a71fdc~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp",alt:""})}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsxs)(r.em,{children:["\u6b64\u65f6",(0,s.jsx)(r.code,{children:"DOM"}),"\u66f4\u65b0\u4e3a\u53f3\u4fa7\u6811\u5bf9\u5e94\u7684\u6837\u5b50\u3002"]})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"rootFiberNode"}),"\u7684",(0,s.jsx)(r.code,{children:"current"}),"\u6307\u9488\u6307\u5411",(0,s.jsx)(r.code,{children:"workInProgress Fiber\u6811"}),"\u4f7f\u5176\u53d8\u4e3a",(0,s.jsx)(r.code,{children:"current Fiber \u6811"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"update\u66f4\u65b0\u65f6",children:"Update\uff08\u66f4\u65b0\u65f6\uff09"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u89e6\u53d1\u72b6\u6001\u6539\u53d8\uff0c\u8fd9\u4f1a\u5f00\u542f\u4e00\u6b21\u65b0\u7684",(0,s.jsx)(r.code,{children:"render\u9636\u6bb5"}),"\u5e76\u6784\u5efa\u4e00\u68f5",(0,s.jsx)(r.code,{children:"workInProgress Fiber \u6811"}),"\u3002"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/29/172ff7f358e3a004~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp",alt:""})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\u5176\u4e2d\u5f88\u591a",(0,s.jsx)(r.code,{children:"workInProgress fiber"}),"\u7684\u521b\u5efa\u53ef\u4ee5\u590d\u7528",(0,s.jsx)(r.code,{children:"current Fiber\u6811"}),"\u5bf9\u5e94\u7684\u8282\u70b9\u6570\u636e\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.code,{children:"workInProgress Fiber \u6811"}),"\u5728",(0,s.jsx)(r.code,{children:"render\u9636\u6bb5"}),"\u5b8c\u6210\u6784\u5efa\u540e\u8fdb\u5165",(0,s.jsx)(r.code,{children:"commit\u9636\u6bb5"}),"\u6e32\u67d3\u5230\u9875\u9762\u4e0a\u3002"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/29/172ff7ffbecaf9e5~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp",alt:""})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\u6e32\u67d3\u5b8c\u6bd5\u540e\uff0c",(0,s.jsx)(r.code,{children:"workInProgress Fiber \u6811"}),"\u53d8\u4e3a",(0,s.jsx)(r.code,{children:"current Fiber \u6811"}),"\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"\u533a\u5206fiber-root-\u4e0e-rootfiber",children:"\u533a\u5206fiber Root \u4e0e rootFiber"}),"\n",(0,s.jsx)(r.h3,{id:"fiber-root",children:"fiber Root"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u8868\u793aFiber\u6570\u636e\u7ed3\u6784\u5bf9\u8c61\uff0c\u662fFiber\u6570\u636e\u7ed3\u6784\u4e2d\u7684\u5916\u5c42\u5bf9\u8c61"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u662f\u6574\u4e2a\u5e94\u7528\u7684\u6839\u8282\u70b9\uff0c\u5b83\u5305\u542b\u4e86\u5e94\u7528\u6302\u8f7d\u7684\u76ee\u6807\u8282\u70b9\u4fe1\u606f\uff0c\u5e76\u4e14\u8bb0\u5f55\u4e86\u6574\u4e2a\u5e94\u7528\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u7684\u5404\u79cd\u4fe1\u606f\u3002"}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://gitee.com/lao-jiawei/photo-gallery/raw/master/images/react/fiberRoot-1.jfif",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u5305\u542b",(0,s.jsx)(r.code,{children:"rootFiber"}),"\uff0c\u5728",(0,s.jsx)(r.code,{children:"current"}),"\u5c5e\u6027\u4e2d\uff0c\u5b58\u50a8",(0,s.jsx)(r.code,{children:"footFiber"})]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u5728React\u5e94\u7528\u4e2d",(0,s.jsx)(r.code,{children:"FiberRoot"}),"\u53ea\u6709\u4e00\u4e2a\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u4f1a\u8bb0\u5f55\u5e94\u7528\u7684\u66f4\u65b0\u4fe1\u606f"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"rootfiber",children:"rootFiber"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u8868\u793a\u7ec4\u4ef6\u6302\u8f7d\u70b9\u5bf9\u5e94\u7684Fiber\u5bf9\u8c61"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:["\u662f",(0,s.jsx)(r.code,{children:"Fiber Root"}),"\u7684\u4e00\u90e8\u5206\uff0c\u901a\u5e38\u662f\u5e94\u7528\u4e2d\u9ed8\u8ba4\u7684\u7ec4\u4ef6\u6302\u8f7d\u70b9"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://gitee.com/lao-jiawei/photo-gallery/raw/master/images/react/fiberRoot-3.jfif",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u6307\u5411",(0,s.jsx)(r.code,{children:"fiberRoot"}),"\uff0c\u5728",(0,s.jsx)(r.code,{children:"rootFiber"}),"\u5bf9\u8c61\u4e2d\u7684",(0,s.jsx)(r.code,{children:"stateeNode"}),"\uff0c\u6307\u5411",(0,s.jsx)(r.code,{children:"fiberRoot"})]}),"\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.img,{src:"https://gitee.com/lao-jiawei/photo-gallery/raw/master/images/react/fiberRoot-2.jfif",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:["\u5728React\u5e94\u7528\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a",(0,s.jsx)(r.code,{children:"rootFiber"}),"\uff0c\u56e0\u4e3arender\u65b9\u6cd5\u53ef\u4ee5\u88ab\u8c03\u7528\u591a\u6b21\u3002"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,c.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(j,{...e})}):j(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>l});var s=n(6540);const c={},i=s.createContext(c);function o(e){const r=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);